<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>멘토링 수강신청</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous" />
        <link
        rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />

      <!-- J query -->
  <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.12.4.min.js">

  </script>
        <link rel="stylesheet" href="style.css" />
</head>

<body>
    <div>
        <h1>
            성균관대학교 튜터링 수강신청
        </h1>
    </div>

    <div id="status_form">
        <div>
            <img src="SKKU Logo1.jpg" style="margin-top: 10px" width="120" />
            <br /><br />
        </div>
        <div class="userinfo_box">
            <b>이름 :</b><span id="info_name"></span><br />
            <b>학번 :</b><span id="info_studentnum"></span> <br />
            <b>학과(전공) :</b><span style="margin-left:3px">소프트웨어학과</span>
            <br /><br />
            <button id="logout" onclick="location.href='index.html'">로그아웃</button> <br /><br />
            <a href="./◈ 성균튜터링 안내사항.hwp" download>
            <button type="button" id="downManual">성균튜터링매뉴얼다운로드</button>
            </a>

        </div>
    </div>

    <div id="application_form">
        <input type="radio" id="tab-1" name="show" checked />
        <input type="radio" id="tab-2" name="show" />
        <input type="radio" id="tab-3" name="show" />
        <input type="radio" id="tab-4" name="show" />

        <div class="tab_box">
          <div class="tab">
            <label class ="other_tab" for="tab-1">공지사항</label>
            <label id ="course_enroll"  for="tab-2">수강신청</label>
            <label for="tab-3">전공수업조회</label>
          </div>
        
          <div class="under_tab">

            <div class="under_tab1">
              <div class="course_select_btn">과목 신청</div>
              <select name="sugang" id="course_select">
            </select>
            </div>
            
            <div class="under_tab1">
              <div>
                <span style="margin-right: 5px;">◈ 학수번호-분반 :</span>
              </div>
              <div>
                <input type="text" name="gwamok" id="gwamok" size="10" maxlength="7">
                -
                <input type="text" name="ban" id="ban" size="4" maxlength="2" onkeydown="if(event.keyCode == 13) fastSave();">
              </div>
              <div id="searchbtn" class="bar_enrollbtn">수강신청</div>
            </div>
        </div>
        </div>



        <div class="content">
            <div class="content-dis">
                <div id="notice_box">
                    <img id="notice_img" src="tutoring_img.png">
                    <h3>◈ 성균튜터링이란?</h3>

                    <p>
                        해당과목에서 A이상 학점을 받은 튜터와 학습에 도움을 받고자 하는
                        튜티들이 그룹학습을 할 수 있도록 매칭하고 지원하는 프로그램 ※이번
                        학기 성균튜터링은 "온라인(실시간 화상) 또는 온/오프라인 혼합"
                        방식으로 운영됩니다. (코로나 확산에 따라 변경될 수 있음)
                    </p>
                    <h3>◈ 신청방법</h3>
                    <p>
                    <h4>1)신청과목: 이번 학기 개설 과목</h4>
                    -튜터: 이번 학기 개설 과목 중 취득학점이 A이상인 과목(본교 재학중인 학부생에 한함)<br>
                    -튜티: 이번 학기 수강하는 과목 중 튜터링 희망 과목으로 신청서에 작성<br />
                    </p>
                    <p>
                    <h4>2)신청자격 및 링크</h4>
                    -튜터: 신청과목의 취득학점이 A이상인 학부생 <br>
                    -튜티: 이번 학기 튜터링 과목의 수강생 <br>
                    <a href=http://bit.ly/skkututee target="_blank">http://bit.ly/skkututee</a><br />
                    </p>
                    <p>
                    <h4>3)모집기간</h4>
                    ~ 9월 7일(수), 9월 14일(수) 결과 발표→홈페이지 및 카페공지
                    <br>
                    </p>
                    <br>
                    <h3>◈ 이수기준</h3>
                    <p>
                        1)온라인 OT 수강<br>
                        2)10회 & 15시간 튜터링 진행 (+매회 활동보고서 작성)<br>
                        3)현장모니터링 1회 필수<br>
                    </p><br />

                    <h3>◈ 이수혜택</h3>
                    <p>
                        1)공통: 팀 활동지원금 최대15만원, 3품제 창의품 비교과 시간인정<br />
                        2)튜터: 3품제 인성품 교내봉사(최대 20시간)<br />
                        3)우수활동튜터: 상장 및 시상금<br />
                        4)최우수튜터: 교환학생 선발 가점<br />
                    </p><br />

                    <h3>◈ 유의사항</h3>
                    <p>
                        1) 2022학년도 학사일정에 따라 운영일정 및 수료기준이 변동될 수 있습니다.<br>
                        2) 지원자격에 위배되는 경우에는 OT 이후에도 선발이 취소될 수 있습니다.<br>
                        3) 튜터는 활동 전에 아이캠퍼스 온라인 OT를 반드시 수강해야 합니다. (추후 튜터에게 개별 안내)<br>
                        4) 이번 한 학기 동안 10회 & 15시간 이상 참여해야하므로, 튜터와 튜티 모두 책임감을 가지고 신청하시기 바랍니다.<br>
                        노쇼(No-Show, 특별한 사유 없이 취소/불참)의 경우, 추후 교육개발센터의 프로그램 참여에 제한이 있습니다.<br>
                        5) 튜터-튜티가 사전에 팀을 이루어 그룹(튜터 포함 6인 이내)으로 신청 가능합니다. 단, 이 경우에도 모든 구성원들이
                        신청링크에 개별 접속하여 신청해주세요.<br>
                        6) 공지를 숙지하지 않아 발생한 문제는 교육개발센터에서 책임지지 않습니다.<br>
                    </p><br />

                    <h3>◈ 튜터링 신청 과목 현황(22.9.5 기준)</h3>
                    <p>
                        ※ 신청된 과목 리스트이며 리스트에 없는 과목들도 튜터 튜티 모두 신청 가능합니다. <br>
                        ※ 신청했지만 리스트에 없는 경우는 튜터 튜티 모두 신청하여 매칭 예정될 과목입니다.<br>
                        ※ 해당 과목 튜터가 없는 경우 선발 불가<br>
                        ※ 해당 과목 튜티가 1명 이하인 경우 선발 불가<br>
                        ※ 해당 과목 튜티가 5명을 초과하는 경우 (선착순 선발)<br>
                    </p><br />

                    <footer>
                        <address>Contact webmaster for more information. 02-760-0988</address>
                    </footer>

                </div>
            </div>
            <div class="content-dis" id="contents">

            </div>
            <div id= "contents_all" class="content-dis">전공수업조회</div>
            <div class="content-dis">교양수업조회</div>
        </div>
    </div>

    <button type="button" id="tutorLectureBtn" style="float: right; margin: 5px 10px; width:200px; height:50px"
        onclick="tutorLecture()">튜터링과목등록</button>

    
        <div id="curApplication_form">
            <div id="mycourseinfo"style="text-align:center">
                수강 신청 내역
            </div>
            <table class="usertable">
            <thead>
                <th>학수번호 - 분반</th>
                <th>교과목명</th>
                <th>교강사</th>
                <th>Tutor</th>
                <th>수강인원</th>
                <th>수업시간/온오프</th>
            </thead>
            <tbody class="user_body">

            </tbody>

            </table>
            <b></b>
    
        </div>

        <div id="my_modal">
            <div>
                <b>튜터명:</b>&nbsp<span class="plus_tutorname" id="tutor"
                    >조재민</span>
            </div>
            <div>
                <b>튜터취득성적:</b>&nbsp<span
                    class="plus_tutorscore"
                    id="grade"
                    >A+</span
                >
            </div>
            <b>튜터메시지</b>
            <div class="plus_tutormsg" id="tutor message"></div>
            <b>튜터링 진행 계획</b>
            <div class="plus_tutormsg" id="tutor syllabus"></div>
            <a class="modal_close_btn"
                ><span class="material-symbols-outlined"> close </span></a
            >
        </div>


    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
      crossorigin="anonymous"
    ></script>
    

      
    <script>
        //let enroll_table = document.getElementsByClassName('.enroll_table');
        //var arr = Array.prototype.slice.call( enroll_table )
    
    </script>
    

    <script type="text/javascript" src="main.js"></script>
    <script type="text/javascript" src="application.js"></script>
    <script type="text/javascript" src="tutorLecture.js"></script>

    <script>
        let temp = location.href.split("?");
        let data = temp[1].split(":");
        const id = data[0];
        const name = data[1];

        document.getElementById("info_name").innerText = name;
        document.getElementById("info_studentnum").innerText = id;

        

        console.log(id + ", "+ name);

        //내 수강과목 조회

        temp_arr = {

        }
        let idx=0;

        const mycourses = allmycourses(id);

        mycourses.then( (result) => {
            let curApplication_form = document.querySelector("#curApplication_form");
            
           
        Object.keys(result.courses)
            .forEach(element => {
                let temp = {

                };
                temp.id         = result["courses"][element]["id"];
                temp.name       = result["courses"][element]["name"];
                temp.professor  = result["courses"][element]["professor"];
                temp.tutor      = result["courses"][element]["tutor"];
                temp.tutee      = result["courses"][element]["tutee"];
                temp.tuteeNum   = result["courses"][element]["tuteeNum"];

                temp_arr[idx] = temp;
                idx++;

                
            });

            console.log(temp_arr);
            console.log(typeof(temp_arr));

            //console.log("-----------------------------------------------");
           // console.log(temp.id,temp.name,temp.professor,temp.tutor);
            //console.log("-----------------------------------------------");

            for (var key in temp_arr){
                
            let user_body = document.querySelector(".user_body");

                console.log(temp_arr[key].id);

                let my_course = document.createElement("tr");
                my_course.innerHTML =
                    '<tr>'  +
                        '<td>' + temp_arr[key].id + '</td>' + 
                       '<td>' + temp_arr[key].name+ '</td>' +
                       '<td>' + temp_arr[key].professor + '</td>' + 
                       '<td>' + temp_arr[key].tutor + '</td>' + 
                       '<td>' + temp_arr[key].tuteeNum +'/5'+ '</td>' + 
                       '<td>' + '11:00~12:00/offline' + '</td>' +                 
                       '</tr>'

    
                    user_body.appendChild(my_course); 
            }


            
        });






        //1.탭바에 학수번호-분반검색후 mycourse등록=======================
        const searchbtn= document.getElementById('searchbtn');

        searchbtn.addEventListener('click', function(){
            let gwamok = document.getElementById("gwamok");
            let ban = document.getElementById("ban");

            inputval_1=gwamok.value;
            inputval_2=ban.value;

            gwamok.value="";
            ban.value="";
            const check1 = isinLecture(inputval_1 + "-" +inputval_2);
            console.log(inputval_1 + "-" +inputval_2);

            //서버과목코드에 있다면 확인후 mycourse에 넣습니다.
            check1.then(
                (data) => {
                    if(data.success){
                        const check2 = tuteeApplication(id, inputval_1 + "-" +inputval_2);
                        check2.then(
                            (data) => {
                                if(data.success){

                                }
                                else{
                                    alert("Applicatoin Failed.");
                                }
                            }
                        )
                    }else{
                        alert("its wrong class num.");
                    }
                }
            )


            // console.log(gwamok);
            // console.log(gwamok,ban);
        });

        //해당하는 과목이 존재하는지 서버로부터 받아옵니다. 존재하는 경우 success = True
        async function isinLecture(course_id) {
            let data = {
                "id" : course_id
            };
            return await fetch(URL + "/isinLecture", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(data)
            })
                .then((response) => response.json());
        }

        //튜터링 신청
        //튜터링 수강 신청 - 튜티
        //return is true/false
        async function tuteeApplication(tutee_id, course_id) {
            let data = {
                "id": course_id,
                "tutee": tutee_id,
            };
            return await fetch(URL + "/addtutee", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(data)
            })
                .then((response) => response.json());
        }
    </script>



<script>

    //검색 탭 기능
      $(document).ready(function(){
      $('.under_tab').css("display","none");


      $("#course_enroll").on("click", function () {
          $('.under_tab').show();
    });

    $(".other_tab").on("click", function () {
          $('.under_tab').hide();
    });


    //네비바 수강신청기능1
     //선택한 select 과목값
    $(".course_select_btn").on("click", function () {
        $("select[name=sugang]").change(function(){
        let selectcourse = $(this).val();
        console.log(selectcourse)
        //선택 selectcourse value값(학수번호) 가져오기
    // DB에 있는지 확인후 해당과목을 mycourse에 추가한다
    // 선택한 option의 value 값
    });
    
    

  
});



// process.. 
});



</script>
</body>

</html>